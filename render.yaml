services:
  - type: web
    name: police-chatbot-backend
    runtime: python
    region: oregon  # or singapore for closer to India
    plan: free  # Change to 'starter' for production ($7/month)
    branch: main
    
    buildCommand: pip install --upgrade pip && pip install -r requirements.txt
    startCommand: gunicorn main:app --workers 2 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:$PORT --timeout 120 --keep-alive 5
    
    healthCheckPath: /health
    
    envVars:
      # OpenAI Configuration
      - key: OPENAI_API_KEY
        sync: false  # Set in Render dashboard
      
      # Qdrant Configuration
      - key: QDRANT_URL
        sync: false
      - key: QDRANT_API_KEY
        sync: false
      - key: QDRANT_COLLECTION
        value: website_content
      
      # Sarvam AI Configuration
      - key: SARVAM_API_KEY
        sync: false
      
      # Model Configuration
      - key: CHAT_MODEL
        value: gpt-4o
      - key: EMBEDDING_MODEL
        value: text-embedding-3-small
      - key: TRANSLATION_MODEL
        value: gpt-4o-mini
      
      # Application Configuration
      - key: MAX_HISTORY_MESSAGES
        value: 10
      - key: ALLOWED_ORIGINS
        value: "*"  # Change to your Streamlit domain in production
      
      # Python Configuration
      - key: PYTHON_VERSION
        value: 3.11.0
      
      # Debug (set to 'false' in production)
      - key: DEBUG
        value: false
